<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">

    <link rel="shortcut icon" href="

   
<a class="edit-link" href="https://github.com/mongodb/mongo-cxx-driver/blob/master/docs/content/mongocxx-v3/configuration.md" target="_blank" title="Edit mongocxx-v3/configuration.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>













<h1 id="configuring-the-driver">Configuring the driver</h1>

<p>In the mongocxx driver, most configuration is done via the <a href="https://docs.mongodb.com/master/reference/connection-string/">connection
URI</a>.  Some
additional connection options are possible via the
<a href="https://mongodb.github.io/mongo-cxx-driver/api/mongocxx-v3/classmongocxx_1_1options_1_1client.html
">mongocxx::options::client</a> class.</p>

<h2 id="configuring-tls-ssl">Configuring TLS/SSL</h2>

<p>To enable TLS (SSL), set <code>ssl=true</code> in the URI:</p>

<blockquote>
<p><code>mongodb://mongodb.example.com/?ssl=true</code></p>
</blockquote>

<p>By default, mongocxx will verify server certificates against the local
system CA list.  You can override that by creating a
<a href="https://mongodb.github.io/mongo-cxx-driver/api/mongocxx-v3/classmongocxx_1_1options_1_1ssl.html
">mongocxx::options::ssl</a>
object and passing it to <code>ssl_opts</code> on mongocxx::options::client.</p>

<p>For example, to use a custom CA or to disable certificate validation,
uncomment the corresponding line in the following example:</p>

<pre><code class="language-cpp">mongocxx::options::client client_options;
mongocxx::options::ssl ssl_options;

// If the server certificate is not signed by a well-known CA,
// you can set a custom CA file with the `ca_file` option.
// ssl_options.ca_file(&quot;/path/to/custom/cert.pem&quot;);

// If you want to disable certificate verification, you
// can set the `allow_invalid_certificates` option.
// ssl_options.allow_invalid_certificates(true);

client_options.ssl_opts(ssl_options);
</code></pre>

<h2 id="configuring-authentication">Configuring authentication</h2>

<h3 id="default-authentication-mechanism">Default authentication mechanism</h3>

<p>MongoDB 3.0 changed the default authentication mechanism from MONGODB-CR
to SCRAM-SHA-1. To create a credential that will authenticate properly
regardless of server version, use a connection string with the user and
password directly in the URI and with a parameter specifying the database
to authenticate from:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto client = mongocxx::client{uri{&quot;mongodb://user1:pwd1@host1/?authSource=db1&quot;}};
</code></pre>

<h3 id="scram-sha-1">SCRAM-SHA-1</h3>

<p>To explicitly create a credential of type SCRAM-SHA-1 use a connection
string as above but with a parameter specifying the authentication
mechanism as &ldquo;SCRAM-SHA-1&rdquo;:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto client = mongocxx::client{
    uri{&quot;mongodb://user1:pwd1@host1/?authSource=db1&amp;authMechanism=SCRAM-SHA-1&quot;}};
</code></pre>

<h3 id="mongodb-cr">MONGODB-CR</h3>

<p>To explicitly create a credential of type MONGODB-CR use a connection
string as above but with a parameter specifying the authentication mechanism
as &ldquo;MONGODB-CR&rdquo;:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto client = mongocxx::client{
    uri{&quot;mongodb://user1:pwd1@host1/?authSource=db1&amp;authMechanism=MONGODB-CR&quot;}};
</code></pre>

<p>Note that this is not recommended as a credential created in this way will
fail to authenticate after an authentication schema upgrade from
MONGODB-CR to SCRAM-SHA-1.</p>

<h3 id="x-509">X.509</h3>

<p>The <a href="https://www.mongodb.org/dochub/core/x509">X.509</a>
mechanism authenticates a user whose name is derived from the distinguished
subject name of the X.509 certificate presented by the driver during SSL
negotiation. This authentication method requires the use of SSL
connections with certificate validation and is available in MongoDB 2.6
and newer. To create a credential of this type, first create a set of
client options specifying the path to the PEM file containing the client
private key and certificate, and then use a connection string with a
parameter specifying the authentication mechanism as &ldquo;MONGODB-X509&rdquo; and
with SSL enabled:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;
#include &lt;mongocxx/options/client.hpp&gt;
#include &lt;mongocxx/options/ssl.hpp&gt;

mongocxx::options::ssl ssl_opts{};
ssl_opts.pem_file(&quot;client.pem&quot;);

mongocxx::options::client client_opts{};
client_opts.ssl_opts(ssl_opts);

auto client = mongocxx::client{
    uri{&quot;mongodb://host1/?authMechanism=MONGODB-X509&amp;ssl=true&quot;}, client_opts};
</code></pre>

<p>See the MongoDB server
<a href="https://www.mongodb.org/dochub/core/x509-subject-name">X.509 tutorial</a>
for more information about determining the subject name from the
certificate.</p>

<h3 id="kerberos-gssapi">Kerberos (GSSAPI)</h3>

<p><a href="https://www.mongodb.com/products/mongodb-enterprise">MongoDB Enterprise</a>
supports proxy authentication through Kerberos service. To create a
credential of type <a href="https://www.mongodb.org/dochub/core/kerberos">Kerberos (GSSAPI)</a>
use a connection string with the username and realm in the URI as well as
a parameter specifying the authentication mechanism as &ldquo;GSSAPI&rdquo;:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto client = mongocxx::client{
    uri{&quot;mongodb://username%40REALM.COM@host1/?authMechanism=GSSAPI&quot;}};
</code></pre>

<p>Note that the &ldquo;@&rdquo; symbol in the URI must be escaped to &ldquo;%40&rdquo; as shown in the example above.</p>

<h3 id="ldap">LDAP</h3>

<p><a href="http://www.mongodb.com/products/mongodb-enterprise">MongoDB Enterprise</a>
supports proxy authentication through a Lightweight Directory Access
Protocol (LDAP) service. To create a credential of type LDAP use a
connection string specifying the user as well as parameters specifying
the authentication source as &ldquo;$external&rdquo; and the authentication mechanishm
as &ldquo;PLAIN&rdquo;:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto client = mongocxx::client{
    uri{&quot;mongodb://user1:pwd1@host1/?authSource=$external&amp;authMechanism=PLAIN&quot;}};
</code></pre>

<h2 id="configuring-a-connection-pool">Configuring a connection pool</h2>

<p>To configure a connection pool, first create a <code>mongocxx::pool</code>, passing
the URI as an argument. The size of the pool can be configured in the URI.
Then, call <code>mongocxx::pool::acquire</code> to receive a client from the pool.
The client will automatically be returned to the pool when it goes out of
scope.</p>

<pre><code class="language-cpp">#include &lt;mongocxx/pool.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto pool = mongocxx::pool{uri{&quot;mongodb://host1/?minPoolSize=3&amp;maxPoolSize=5&quot;}};

{
    // To get a client from the pool, call `acquire()`.
    auto client = pool.acquire();

    // The client is returned to the pool when it goes out of scope.
}
</code></pre>

<p>See <a href="../connection-pools">connection pool documentation</a> for more details.</p>






<div id="btnv">
  
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
<ul>
<li><a href="#configuring-the-driver">Configuring the driver</a>
<ul>
<li><a href="#configuring-tls-ssl">Configuring TLS/SSL</a></li>
<li><a href="#configuring-authentication">Configuring authentication</a>
<ul>
<li><a href="#default-authentication-mechanism">Default authentication mechanism</a></li>
<li><a href="#scram-sha-1">SCRAM-SHA-1</a></li>
<li><a href="#mongodb-cr">MONGODB-CR</a></li>
<li><a href="#x-509">X.509</a></li>
<li><a href="#kerberos-gssapi">Kerberos (GSSAPI)</a></li>
<li><a href="#ldap">LDAP</a></li>
</ul></li>
<li><a href="#configuring-a-connection-pool">Configuring a connection pool</a></li>
</ul></li>
</ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    

<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-K75Z5Q"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
{'gtm.start': new Date().getTime(),event:'gtm.js'}
);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K75Z5Q');</script>


<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '413370795']);
_elqQ.push(['elqTrackPageView']);
(function () {
function async_load()
{ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//img03.en25.com/i/elqCfg.min.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); }
if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>

</body>
</html>

