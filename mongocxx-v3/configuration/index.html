<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">

    <link rel="shortcut icon" href="http://mongocxx.org/img/favicon.png">

    <title>Configuring the mongocxx driver</title>

    <link rel="stylesheet" href="http://mongocxx.org/lib/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="http://mongocxx.org/lib/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="http://mongocxx.org/css/mongodb-docs.css" type="text/css" />
<link rel="stylesheet" href="http://mongocxx.org/css/overrides.css" type="text/css" />
<link rel="stylesheet" href="http://mongocxx.org/lib/highlight/styles/idea.css" />

  </head>

  <body>
  
  <section id="container" class="">
      
      <header id="header-db" class="row" role="navigation">
  <div class="header-content">
    <div class="toggle-nav pull-left">
        <i class="fa fa-bars"></i>
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
    </div>
    
    <div class="logo pull-left">
      <a href="http://mongocxx.org">
        <img src="http://mongocxx.org/img/logo-mongodb-header.png",
             alt="MongoDB C++ driver" />
      </a>
    </div>
    
    <div>
<div class="nav-items pull-right">
  <div id="search">
<form method="get" action="//www.google.com/search" target="_blank">
    <input type="text" name="searchQuery" size="20" value="" autocomplete="off" placeholder="Search">
    <input type="hidden" name="site" value="http://mongocxx.org">
    <input type="hidden" name="q" value="">
    <label for="searchQuery"><i class="fa fa-search fa-1"></i></label>
</form>
</div>

</div>
</div>

  </div>
</header>

      

      
<aside id="sidebar" class="sidebar">
    <div class="ssidebar nav-collapse">
      <div class="ssidebarwrapper">
        <h3>
          <a class="index-link" href="http://mongocxx.org">MongoDB C&#43;&#43; Driver Manual</a>
        </h3>

        
        <ul class="sidebar-menu">
          
          
          
          
          
          
          
          
          
          
          
          

          
          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
  
  
  
  
  
  
  

  
    
    
    
  
  


        
      
    
      
      
        
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    
  


          
            
            









  
    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    
  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  
    
    
      
      
    
      
      
    
      
      
    
    
  


          

          

          
            
            













  




<li class="toctree-l1  current">
  <a href="/mongocxx-v3/" class="">
      <i class='fa fa-arrow-right'></i>
      <span>mongocxx (v3)</span>
      <span class="menu-arrow fa fa-angle-down"></span>
  </a>
    <ul  class="current">
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/installation/">
        
        Installing the mongocxx driver
    </a>
  </li>


        
        
        
        
        













  




    <li class="toctree-l2">
    <a href="/mongocxx-v3/configuration/">
        
        Configuring the mongocxx driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/tutorial/">
        
        Tutorial for mongocxx
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/thread-safety/">
        
        Thread and fork safety
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/connection-pools/">
        
        Connection pools
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/working-with-bson/">
        
        Working with BSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/api-abi-versioning/">
        
        API and ABI versioning
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/mongocxx-v3/">
        
        The mongocxx (v3) driver
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/legacy-v1/" class="">
      <i class='fa fa-arrow-right'></i>
      <span>legacy (v1)</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/installation/">
        
        Installing the legacy driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/configuration/">
        
        Configuring the legacy driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/tutorial/">
        
        Legacy driver tutorial
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/working-with-bson/">
        
        Working with BSON
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/breaking-changes/">
        
        Breaking changes from 26compat
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/legacy-v1/">
        
        The Legacy C&#43;&#43; Driver
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://mongodb.github.io/mongo-cxx-driver/api/current">
        <i class='fa fa-file-text-o'></i>
        API Documentation
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/getting-help/">
        <i class='fa fa-question'></i>
        Getting help
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/reporting-bugs/">
        <i class='fa fa-bug'></i>
        Reporting Bugs
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://github.com/mongodb/mongo-cxx-driver/">
        <i class='fa fa-github'></i>
        Source Code
    </a>
  </li>


          
            
            
















<li class="toctree-l1 ">
  <a href="/contributing/" class="">
      <i class='fa fa-pencil'></i>
      <span>Contributing</span>
      <span class="menu-arrow fa fa-angle-right"></span>
  </a>
    <ul >
        
        
        
        
















    <li class="toctree-l2">
    <a href="/contributing/testing-mongocxx/">
        
        Testing the mongocxx driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/contributing/testing-legacy/">
        
        Testing the legacy driver
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/contributing/">
        
        Contribution Guidelines
    </a>
  </li>


        
        
    </ul>
  </li>


          
        </ul>
        
    </div>
  </div>
  

</aside>



      
      <section id="main-content" class="content">
          <section class="main-column pull-left">
            <div class="document">
              <div class="documentwrapper">
                <div class="bodywrapper">
                  <div class="body">


   
<a class="edit-link" href="https://github.com/mongodb/mongo-cxx-driver/blob/master/docs/content/mongocxx-v3/configuration.md" target="_blank" title="Edit mongocxx-v3/configuration.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>










<div class="bc">
<ul>
  
  
  
  
  
  <li><a href="/mongocxx-v3/">mongocxx (v3)</a> <i class="fa fa-angle-right"></i></li>
  <li>Configuring the mongocxx driver</li>
</ul>
</div>


<h1>Configuring the mongocxx driver</h1>


<p>In the mongocxx driver, most configuration is done via the <a href="https://docs.mongodb.com/master/reference/connection-string/">connection
URI</a>.  Some
additional connection options are possible via the
<a href="https://mongodb.github.io/mongo-cxx-driver/api/mongocxx-v3/classmongocxx_1_1options_1_1client.html
">mongocxx::options::client</a> class.</p>

<h2 id="configuring-tls-ssl">Configuring TLS/SSL</h2>

<p>To enable TLS (SSL), set <code>ssl=true</code> in the URI:</p>

<blockquote>
<p><code>mongodb://mongodb.example.com/?ssl=true</code></p>
</blockquote>

<p>By default, mongocxx will verify server certificates against the local
system CA list.  You can override that by creating a
<a href="https://mongodb.github.io/mongo-cxx-driver/api/mongocxx-v3/classmongocxx_1_1options_1_1ssl.html
">mongocxx::options::ssl</a>
object and passing it to <code>ssl_opts</code> on mongocxx::options::client.</p>

<p>For example, to use a custom CA or to disable certificate validation,
uncomment the corresponding line in the following example:</p>

<pre><code class="language-cpp">mongocxx::options::client client_options;
mongocxx::options::ssl ssl_options;

// If the server certificate is not signed by a well-known CA,
// you can set a custom CA file with the `ca_file` option.
// ssl_options.ca_file(&quot;/path/to/custom/cert.pem&quot;);

// If you want to disable certificate verification, you
// can set the `allow_invalid_certificates` option.
// ssl_options.allow_invalid_certificates(true);

client_options.ssl_opts(ssl_options);
</code></pre>

<h2 id="configuring-authentication">Configuring authentication</h2>

<h3 id="default-authentication-mechanism">Default authentication mechanism</h3>

<p>MongoDB 3.0 changed the default authentication mechanism from MONGODB-CR
to SCRAM-SHA-1. To create a credential that will authenticate properly
regardless of server version, use a connection string with the user and
password directly in the URI and with a parameter specifying the database
to authenticate from:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto client = mongocxx::client{uri{&quot;mongodb://user1:pwd1@host1/?authSource=db1&quot;}};
</code></pre>

<h3 id="scram-sha-1">SCRAM-SHA-1</h3>

<p>To explicitly create a credential of type SCRAM-SHA-1 use a connection
string as above but with a parameter specifying the authentication
mechanism as &ldquo;SCRAM-SHA-1&rdquo;:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto client = mongocxx::client{
    uri{&quot;mongodb://user1:pwd1@host1/?authSource=db1&amp;authMechanism=SCRAM-SHA-1&quot;}};
</code></pre>

<h3 id="mongodb-cr">MONGODB-CR</h3>

<p>The MONGODB-CR authMechanism is deprecated and will no longer function in MongoDB 4.0. Instead, specify no authMechanism and the driver
will use an authentication mechanism compatible with your server.</p>

<h3 id="x-509">X.509</h3>

<p>The <a href="https://www.mongodb.org/dochub/core/x509">X.509</a>
mechanism authenticates a user whose name is derived from the distinguished
subject name of the X.509 certificate presented by the driver during SSL
negotiation. This authentication method requires the use of SSL
connections with certificate validation and is available in MongoDB 2.6
and newer. To create a credential of this type, first create a set of
client options specifying the path to the PEM file containing the client
private key and certificate, and then use a connection string with a
parameter specifying the authentication mechanism as &ldquo;MONGODB-X509&rdquo; and
with SSL enabled:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;
#include &lt;mongocxx/options/client.hpp&gt;
#include &lt;mongocxx/options/ssl.hpp&gt;

mongocxx::options::ssl ssl_opts{};
ssl_opts.pem_file(&quot;client.pem&quot;);

mongocxx::options::client client_opts{};
client_opts.ssl_opts(ssl_opts);

auto client = mongocxx::client{
    uri{&quot;mongodb://host1/?authMechanism=MONGODB-X509&amp;ssl=true&quot;}, client_opts};
</code></pre>

<p>See the MongoDB server
<a href="https://www.mongodb.org/dochub/core/x509-subject-name">X.509 tutorial</a>
for more information about determining the subject name from the
certificate.</p>

<h3 id="kerberos-gssapi">Kerberos (GSSAPI)</h3>

<p><a href="https://www.mongodb.com/products/mongodb-enterprise">MongoDB Enterprise</a>
supports proxy authentication through Kerberos service. To create a
credential of type <a href="https://www.mongodb.org/dochub/core/kerberos">Kerberos (GSSAPI)</a>
use a connection string with the username and realm in the URI as well as
a parameter specifying the authentication mechanism as &ldquo;GSSAPI&rdquo;:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto client = mongocxx::client{
    uri{&quot;mongodb://username%40REALM.COM@host1/?authMechanism=GSSAPI&quot;}};
</code></pre>

<p>Note that the &ldquo;@&rdquo; symbol in the URI must be escaped to &ldquo;%40&rdquo; as shown in the example above.</p>

<h3 id="ldap">LDAP</h3>

<p><a href="http://www.mongodb.com/products/mongodb-enterprise">MongoDB Enterprise</a>
supports proxy authentication through a Lightweight Directory Access
Protocol (LDAP) service. To create a credential of type LDAP use a
connection string specifying the user as well as parameters specifying
the authentication source as &ldquo;$external&rdquo; and the authentication mechanishm
as &ldquo;PLAIN&rdquo;:</p>

<pre><code class="language-cpp">#include &lt;mongocxx/client.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto client = mongocxx::client{
    uri{&quot;mongodb://user1:pwd1@host1/?authSource=$external&amp;authMechanism=PLAIN&quot;}};
</code></pre>

<h2 id="configuring-a-connection-pool">Configuring a connection pool</h2>

<p>To configure a connection pool, first create a <code>mongocxx::pool</code>, passing
the URI as an argument. The size of the pool can be configured in the URI.
Then, call <code>mongocxx::pool::acquire</code> to receive a client from the pool.
The client will automatically be returned to the pool when it goes out of
scope.</p>

<pre><code class="language-cpp">#include &lt;mongocxx/pool.hpp&gt;
#include &lt;mongocxx/uri.hpp&gt;

auto pool = mongocxx::pool{uri{&quot;mongodb://host1/?minPoolSize=3&amp;maxPoolSize=5&quot;}};

{
    // To get a client from the pool, call `acquire()`.
    auto client = pool.acquire();

    // The client is returned to the pool when it goes out of scope.
}
</code></pre>

<p>See <a href="../connection-pools">connection pool documentation</a> for more details.</p>






<div id="btnv">
  
  <div class="pull-left">
  <a class="navigation prev" href="/mongocxx-v3/installation/">
      <i class="fa fa-long-arrow-left"> </i> Installing the mongocxx driver
  </a>
  </div>
  
  
  <div class="pull-right">
  <a class="navigation next" href="/mongocxx-v3/tutorial/">
    Tutorial for mongocxx <i class="fa fa-long-arrow-right"> </i>
  </a>
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#configuring-tls-ssl">Configuring TLS/SSL</a></li>
<li><a href="#configuring-authentication">Configuring authentication</a>
<ul>
<li><a href="#default-authentication-mechanism">Default authentication mechanism</a></li>
<li><a href="#scram-sha-1">SCRAM-SHA-1</a></li>
<li><a href="#mongodb-cr">MONGODB-CR</a></li>
<li><a href="#x-509">X.509</a></li>
<li><a href="#kerberos-gssapi">Kerberos (GSSAPI)</a></li>
<li><a href="#ldap">LDAP</a></li>
</ul></li>
<li><a href="#configuring-a-connection-pool">Configuring a connection pool</a></li>
</ul></li>
</ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    "http://mongocxx.org",
   VERSION:     "",
   COLLAPSE_INDEX: false,
   FILE_SUFFIX: '.html',
   HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="http://mongocxx.org/js/jquery.js"></script>
<script type="text/javascript" src="http://mongocxx.org/lib/bootstrap.js"></script>
<script type="text/javascript" src="http://mongocxx.org/js/navbar.js"></script>
<script type="text/javascript" src="http://mongocxx.org/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="http://mongocxx.org/js/scripts.js"></script>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-JQHP"
                 height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
  {'gtm.start': new Date().getTime(),event:'gtm.js'}
);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-JQHP');</script>


<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '413370795']);
_elqQ.push(['elqTrackPageView']);
(function () {
function async_load()
{ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//img03.en25.com/i/elqCfg.min.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); }
if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>

</body>
</html>

